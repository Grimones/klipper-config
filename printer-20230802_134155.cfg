[gcode_macro _km_options]
variable_bed_surfaces: []
variable_menu_temperature: [
  {'name' : 'PLA',  'extruder' : 210, 'bed' : 55},
  {'name' : 'PETG', 'extruder' : 230, 'bed' : 80}]
variable_start_purge_length: 20.0
variable_start_bed_heat_overshoot: 1.0
variable_start_extruder_preheat_scale: 0.6
variable_start_extruder_probing_temp: 150
gcode: # This line is required by Klipper.

[include klipper-macros/*.cfg]
[include klipper-macros/optional/bed_mesh.cfg]
[include macros/GET_PROBE_LIMITS.cfg]

# <---------------------- Klipper macros ---------------------->
[idle_timeout]
gcode:
  _KM_IDLE_TIMEOUT

[pause_resume]

[respond]

[save_variables]
filename: ~/printer_data/variables.cfg

[virtual_sdcard]
path: ~/printer_data/gcodes
on_error_gcode: CANCEL_PRINT

[display_status]
# <----------------------------------------------------------->

[include OrbiterSensor.cfg]

[include generic-bigtreetech-manta-m8p-V1_1.cfg]

[safe_z_home]
# home_xy_position: 113.5,120.5 # HM7 Nozzle
# home_xy_position: 158,123.7 # HM7 Probe
home_xy_position: 113.5,160.46 # Manta MK2
z_hop: 10

[bed_mesh]
speed: 500
horizontal_move_z: 10
# mesh_min: 5.7, 9 # HM7
# mesh_max: 205.7, 215 # HM7
mesh_min: 5, 5 # Manta MK2
mesh_max: 225.00, 185.00 # Manta MK2
probe_count: 5, 5
mesh_pps: 5, 5
algorithm: bicubic
fade_start: 1
fade_end: 10
fade_target: 0

[screws_tilt_adjust]
screw1_name: rear left screw
# screw1: 29.0,204.5 # HM7 Nozzle
# screw1: 73.5,207.7 # HM7 Probe
screw1: 29.0,230 # Manta MK2

screw2_name: front left screw
# screw2: 29.0,34.5 # HM7 Nozzle
# screw2: 73.5,37.7 # HM7 Probe
screw2: 29.0,77.66 # Manta MK2

screw3_name: rear right screw
# screw3: 199.0,204.5 # HM7 Nozzle
# screw3: 243.5,207.7 # HM7 Probe
screw3: 199.0,230 # Manta MK2

screw4_name: front right screw
# screw4: 199.0,34.5 # HM7 Nozzle
# screw4: 243.5,37.7 # HM7 Probe
screw4: 199.0,77.66 # Manta MK2

horizontal_move_z: 10
speed: 50
screw_thread: CW-M4

[include ExcludeObject.cfg]

# Enable arcs support
[gcode_arcs]
resolution: 0.1

[adxl345]
cs_pin: PA6
spi_software_sclk_pin: PA7
spi_software_miso_pin: PA5
spi_software_mosi_pin: PC4
# rate: 1600

[resonance_tester]
accel_chip: adxl345
probe_points:
    113.5,120.5,20  # X100, Y100, Z20 an example

[z_tilt]
z_positions:
  0,117
  235,117
# A list of X, Y coordinates (one per line; subsequent lines
# indented) describing the location of each bed "pivot point". The
# "pivot point" is the point where the bed attaches to the given Z
# stepper. It is described using nozzle coordinates (the X, Y position
# of the nozzle if it could move directly above the point). The
# first entry corresponds to stepper_z, the second to stepper_z1,
# the third to stepper_z2, etc. This parameter must be provided.
points:
  29.0,160.46
  199.0,160.46
# A list of X, Y coordinates (one per line; subsequent lines
# indented) that should be probed during a Z_TILT_ADJUST command.
# Specify coordinates of the nozzle and be sure the probe is above
# the bed at the given nozzle coordinates. This parameter must be
# provided.
speed: 100
# The speed (in mm/s) of non-probing moves during the calibration.
# The default is 50.
horizontal_move_z: 15
# The height (in mm) that the head should be commanded to move to
# just prior to starting a probe operation. The default is 5.
retries: 10
# Number of times to retry if the probed points aren't within
# tolerance.
retry_tolerance: 0.01
# If retries are enabled then retry if largest and smallest probed
# points differ more than retry_tolerance. Note the smallest unit of
# change here would be a single step. However if you are probing
# more points than steppers then you will likely have a fixed
# minimum value for the range of probed points which you can learn
# by observing command output.

#*# <---------------------- SAVE_CONFIG ---------------------->
#*# DO NOT EDIT THIS BLOCK OR BELOW. The contents are auto-generated.
#*#
#*# [extruder]
#*# control = pid
#*# pid_kp = 21.463
#*# pid_ki = 1.202
#*# pid_kd = 95.777
#*#
#*# [heater_bed]
#*# control = pid
#*# pid_kp = 70.703
#*# pid_ki = 1.215
#*# pid_kd = 1028.725
#*#
#*# [input_shaper]
#*# shaper_type_y = mzv
#*# shaper_freq_y = 41.4
#*# shaper_type_x = mzv
#*# shaper_freq_x = 56.0
#*#
#*# [bed_mesh default]
#*# version = 1
#*# points =
#*# 	-0.075096, -0.103221, -0.121346, -0.167596, -0.223221
#*# 	-0.068846, -0.039471, -0.015096, -0.079471, -0.145096
#*# 	-0.020096, 0.040529, 0.044279, 0.014279, -0.070721
#*# 	0.015529, 0.036779, 0.071779, -0.012596, -0.123221
#*# 	-0.000096, -0.001346, 0.048029, -0.031346, -0.213846
#*# x_count = 5
#*# y_count = 5
#*# mesh_x_pps = 5
#*# mesh_y_pps = 5
#*# algo = bicubic
#*# tension = 0.2
#*# min_x = 5.0
#*# max_x = 225.0
#*# min_y = 5.0
#*# max_y = 185.0
